import{ay as z,d as F,r as x,c as A,w as t,o as f,e,g as h,i as O,F as B,a as n,B as H,t as N,C as R,R as L,_ as le,l as ue,f as Z,b as E,u as ee,T as ie}from"./index-DSC3Ms3s.js";import{C as re}from"./index-C7m1n5xG.js";import"./index-Dx-HpozK.js";import{M as Q,I as ae}from"./index-Cl0MKicR.js";import{I as J}from"./index-DbxXUXlj.js";import{T as pe}from"./index-D5xu3zuE.js";import{S as G}from"./index-DYJE_-5E.js";import{M as oe,D as K}from"./index-C9PAZute.js";import{F as W,a as X}from"./index-DP1lsub_.js";/* empty css              */import{d as te}from"./date-BOtkChFv.js";import"./keyboard-DIWrcbmK.js";async function ce(k,I){return z("/api/app/question/add",{method:"POST",headers:{"Content-Type":"application/json"},data:k})}async function me(k,I){return z("/api/app/question/delete",{method:"POST",headers:{"Content-Type":"application/json"},data:k})}async function _e(k,I){return z("/api/app/question/list/page",{method:"POST",headers:{"Content-Type":"application/json"},data:k})}async function fe(k,I){return z("/api/app/question/update",{method:"POST",headers:{"Content-Type":"application/json"},data:k})}const ve=F({__name:"QuestionAdd",props:{visible:{type:Boolean}},emits:["update:visible"],setup(k,{emit:I}){const a=x({questionContent:[{title:"",options:[{result:"",score:0,value:"",key:""}]}],appId:null}),s=x(a.value),$=I,w={questionContent:[{required:!0,message:"题目内容是必填项"}],appId:[{required:!0,message:"应用 ID 是必填项"}]},T=()=>{$("update:visible",!1)},S=()=>{s.value.questionContent.push({title:"",options:[{result:"",score:0,value:"",key:""}]})},M=d=>{s.value.questionContent[d].options.push({result:"",score:0,value:"",key:""})},j=(d,m)=>{s.value.questionContent[d].options.splice(m,1)},P=async()=>{console.log("当前提交表单：",s);const d=await ce(s.value);d.data.code===0?(Q.success("添加成功"),b(),T()):Q.error("添加失败"),console.log("提交结果：",d)},b=()=>{s.value={...a.value}};return(d,m)=>{const u=ae,v=W,o=K,l=R,_=J,V=H,U=L,D=G,q=X,C=oe;return f(),A(C,{footer:!1,visible:d.visible,title:"添加题目",onCancel:T},{default:t(()=>[e(q,{model:s.value,rules:w,"label-col":"{ span: 4 }","wrapper-col":"{ span: 20 }",onSubmit:P},{default:t(()=>[e(v,{field:"appId",label:"应用 ID：","validate-trigger":"blur"},{default:t(()=>[e(u,{modelValue:s.value.appId,"onUpdate:modelValue":m[0]||(m[0]=y=>s.value.appId=y),placeholder:"请输入应用 ID"},null,8,["modelValue"])]),_:1}),e(v,{field:"questionContent",label:"题目内容：","validate-trigger":"blur"},{default:t(()=>[(f(!0),h(B,null,O(s.value.questionContent,(y,i)=>(f(),h("div",{key:i,style:{"margin-bottom":"20px",border:"1px solid #e8e8e8",padding:"20px","border-radius":"8px"}},[e(v,{label:"标题："},{default:t(()=>[e(u,{modelValue:y.title,"onUpdate:modelValue":r=>y.title=r,placeholder:"请输入题目标题"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),(f(!0),h(B,null,O(y.options,(r,c)=>(f(),h("div",{key:c,style:{"margin-bottom":"10px"}},[e(o,{orientation:"left"},{default:t(()=>[n("选项 "+N(c+1),1)]),_:2},1024),e(U,{gutter:16},{default:t(()=>[e(l,{span:24},{default:t(()=>[e(v,{label:"关键字："},{default:t(()=>[e(u,{modelValue:r.key,"onUpdate:modelValue":g=>r.key=g,placeholder:"请输入关键字"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024)]),_:2},1024),e(l,{span:24},{default:t(()=>[e(v,{label:"值："},{default:t(()=>[e(u,{modelValue:r.value,"onUpdate:modelValue":g=>r.value=g,placeholder:"请输入值"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024)]),_:2},1024),e(l,{span:24},{default:t(()=>[e(v,{label:"结果："},{default:t(()=>[e(u,{modelValue:r.result,"onUpdate:modelValue":g=>r.result=g,placeholder:"请输入结果"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024)]),_:2},1024),e(l,{span:24},{default:t(()=>[e(v,{label:"分数："},{default:t(()=>[e(_,{modelValue:r.score,"onUpdate:modelValue":g=>r.score=g,placeholder:"请输入分数",style:{width:"100%"}},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024)]),_:2},1024),e(l,{span:12,style:{display:"flex","align-items":"center","justify-content":"end"}},{default:t(()=>[e(V,{onClick:g=>j(i,c)},{default:t(()=>[n(" 删除")]),_:2},1032,["onClick"]),e(V,{block:"",type:"dashed",onClick:g=>M(i)},{default:t(()=>[n("添加选项")]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1024)]))),128))]))),128))]),_:1}),e(v,null,{default:t(()=>[e(V,{block:"",type:"dashed",onClick:S},{default:t(()=>[n("添加题目")]),_:1})]),_:1}),e(v,{"wrapper-col":"{ span: 20, offset: 4 }"},{default:t(()=>[e(D,{style:{width:"100%","justify-content":"flex-end"}},{default:t(()=>[e(V,{onClick:T},{default:t(()=>[n("取消")]),_:1}),e(V,{type:"primary",onClick:P},{default:t(()=>[n("添加")]),_:1}),e(V,{onClick:b},{default:t(()=>[n("重置")]),_:1})]),_:1})]),_:1})]),_:1},8,["model"])]),_:1},8,["visible"])}}}),be=le(ve,[["__scopeId","data-v-c4416983"]]),ye=F({__name:"QuestionEdit",props:{visible:{type:Boolean},question:{}},emits:["update:visible"],setup(k,{emit:I}){const a=x({...question}),s=I,$={questionContent:[{required:!0,message:"题目内容是必填项"}],appId:[{required:!0,message:"应用 ID 是必填项"}]},w=()=>{s("update:visible",!1)},T=()=>{a.value.questionContent.push({title:"",options:[{result:"",score:0,value:"",key:""}]})},S=b=>{a.value.questionContent[b].options.push({result:"",score:0,value:"",key:""})},M=(b,d)=>{a.value.questionContent[b].options.splice(d,1)},j=async()=>{(await fe(a.value)).data.code===0?(Q.success("修改成功"),P(),w()):Q.error("修改失败")},P=()=>{a.value={...question}};return(b,d)=>{const m=ae,u=W,v=K,o=R,l=J,_=H,V=L,U=G,D=X,q=oe;return f(),A(q,{footer:!1,visible:b.visible,title:"修改题目",width:"800px",onCancel:w},{default:t(()=>[e(D,{model:a.value,rules:$,"label-col":"{ span: 4 }","wrapper-col":"{ span: 20 }",onSubmit:j},{default:t(()=>[e(u,{field:"id",label:"编号："},{default:t(()=>[e(m,{modelValue:a.value.id,"onUpdate:modelValue":d[0]||(d[0]=C=>a.value.id=C),value:b.question.id,disabled:""},null,8,["modelValue","value"])]),_:1}),e(u,{field:"appId",label:"应用 ID：","validate-trigger":"blur"},{default:t(()=>[e(m,{modelValue:a.value.appId,"onUpdate:modelValue":d[1]||(d[1]=C=>a.value.appId=C),placeholder:"请输入应用 ID"},null,8,["modelValue"])]),_:1}),e(u,{field:"questionContent",label:"题目内容：","validate-trigger":"blur"},{default:t(()=>[(f(!0),h(B,null,O(a.value.questionContent,(C,y)=>(f(),h("div",{key:y,style:{"margin-bottom":"20px",border:"1px solid #e8e8e8",padding:"20px","border-radius":"8px"}},[e(u,{label:"标题："},{default:t(()=>[e(m,{modelValue:C.title,"onUpdate:modelValue":i=>C.title=i,placeholder:"请输入题目标题"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),(f(!0),h(B,null,O(C.options,(i,r)=>(f(),h("div",{key:r,style:{"margin-bottom":"10px"}},[e(v,{orientation:"left"},{default:t(()=>[n("选项 "+N(r+1),1)]),_:2},1024),e(V,{gutter:16},{default:t(()=>[e(o,{span:6},{default:t(()=>[e(u,{label:"关键字："},{default:t(()=>[e(m,{modelValue:i.key,"onUpdate:modelValue":c=>i.key=c,placeholder:"请输入关键字"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024)]),_:2},1024),e(o,{span:6},{default:t(()=>[e(u,{label:"值："},{default:t(()=>[e(m,{modelValue:i.value,"onUpdate:modelValue":c=>i.value=c,placeholder:"请输入值"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024)]),_:2},1024),e(o,{span:6},{default:t(()=>[e(u,{label:"结果："},{default:t(()=>[e(m,{modelValue:i.result,"onUpdate:modelValue":c=>i.result=c,placeholder:"请输入结果"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024)]),_:2},1024),e(o,{span:4},{default:t(()=>[e(u,{label:"分数："},{default:t(()=>[e(l,{modelValue:i.score,"onUpdate:modelValue":c=>i.score=c,placeholder:"请输入分数",style:{width:"100%"}},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024)]),_:2},1024),e(o,{span:2,style:{display:"flex","align-items":"center","justify-content":"center"}},{default:t(()=>[e(_,{icon:"icon-delete",onClick:c=>M(y,r)},null,8,["onClick"])]),_:2},1024)]),_:2},1024)]))),128)),e(_,{block:"",type:"dashed",onClick:i=>S(y)},{default:t(()=>[n("添加选项")]),_:2},1032,["onClick"])]))),128)),e(_,{block:"",type:"dashed",onClick:T},{default:t(()=>[n("添加题目")]),_:1})]),_:1}),e(u,{"wrapper-col":"{ span: 20, offset: 4 }"},{default:t(()=>[e(U,{style:{width:"100%","justify-content":"flex-end"}},{default:t(()=>[e(_,{onClick:w},{default:t(()=>[n("取消")]),_:1}),e(_,{type:"primary",onClick:j},{default:t(()=>[n("修改")]),_:1}),e(_,{onClick:P},{default:t(()=>[n("重置")]),_:1})]),_:1})]),_:1})]),_:1},8,["model"])]),_:1},8,["visible"])}}}),Ve=le(ye,[["__scopeId","data-v-a51a9019"]]),Ce={id:"adminQuestionPage"},Qe=F({__name:"AdminQuestionPage",setup(k){const I={current:1,pageSize:7},a=x({}),s=x({...I}),$=x([]),w=x(0),T=async()=>{var l,_;const o=await _e(s.value);o.data.code===0?($.value=((l=o.data.data)==null?void 0:l.records)||[],w.value=((_=o.data.data)==null?void 0:_.total)||0):Q.error("获取用户数据失败，"+o.data.message)},S=()=>{s.value={...I,...a.value}},M=()=>{a.value={}},j=o=>{s.value={...s.value,current:o}};ue(()=>{T()});const P=async o=>{if(!o.id)return;const l=await me({id:o.id});l.data.code===0?(T(),Q.success("删除成功")):Q.error("删除数据失败，"+l.data.message)},b=[{title:"id",dataIndex:"id"},{title:"题目内容",dataIndex:"questionContent",slotName:"questionContent"},{title:"应用 id",dataIndex:"appId"},{title:"用户 id",dataIndex:"userId"},{title:"创建时间",dataIndex:"createTime",slotName:"createTime"},{title:"更新时间",dataIndex:"updateTime",slotName:"updateTime"},{title:"操作",slotName:"optional"}],d=x(!1),m=x(!1),u=x({}),v=o=>{m.value=!0,u.value=o};return(o,l)=>{const _=J,V=W,U=R,D=L,q=H,C=X,y=K,i=E("icon-search"),r=E("icon-refresh"),c=G,g=E("icon-plus"),ne=ie,se=pe,de=re;return f(),h(B,null,[Z("div",Ce,[e(de,{title:"题目列表"},{default:t(()=>[e(D,null,{default:t(()=>[e(U,{flex:2},{default:t(()=>[e(C,{"label-col-props":{span:5},model:a.value,"wrapper-col-props":{span:18},"label-align":"left",onSubmit:S},{default:t(()=>[e(D,{gutter:16},{default:t(()=>[e(U,{span:8},{default:t(()=>[e(V,{field:"appId",label:"应用 id"},{default:t(()=>[e(_,{modelValue:a.value.appId,"onUpdate:modelValue":l[0]||(l[0]=p=>a.value.appId=p),"allow-clear":"","hide-button":"",placeholder:"请输入应用 id"},null,8,["modelValue"])]),_:1})]),_:1}),e(U,{span:8},{default:t(()=>[e(V,{field:"userId",label:"用户 id"},{default:t(()=>[e(_,{modelValue:a.value.userId,"onUpdate:modelValue":l[1]||(l[1]=p=>a.value.userId=p),"allow-clear":"","hide-button":"",placeholder:"请输入用户 id"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(q,{"html-type":"submit",style:{display:"none"}})]),_:1},8,["model"])]),_:1}),e(y,{direction:"vertical",style:{height:"42px"}}),e(U,{flex:"86px",style:{"text-align":"right"}},{default:t(()=>[e(c,{size:18,direction:"horizontal"},{default:t(()=>[e(q,{type:"primary",onClick:S},{icon:t(()=>[e(i)]),default:t(()=>[n(" 查询 ")]),_:1}),e(q,{onClick:M},{icon:t(()=>[e(r)]),default:t(()=>[n(" 重置 ")]),_:1})]),_:1})]),_:1})]),_:1}),e(y,{style:{"margin-top":"0"}}),e(D,{style:{"margin-bottom":"16px"}},{default:t(()=>[e(U,{span:12},{default:t(()=>[e(c,null,{default:t(()=>[e(q,{type:"primary",onClick:l[2]||(l[2]=p=>d.value=!0)},{icon:t(()=>[e(g)]),default:t(()=>[n(" 新建 ")]),_:1})]),_:1})]),_:1}),e(U,{span:12,style:{display:"flex","align-items":"center","justify-content":"end"}},{default:t(()=>[e(ne,{content:"刷新"},{default:t(()=>[Z("div",{class:"action-icon",onClick:S},[e(r,{size:"18"})])]),_:1})]),_:1})]),_:1}),e(se,{columns:b,data:$.value,pagination:{showTotal:!0,pageSize:s.value.pageSize,current:s.value.current,total:w.value},onPageChange:j},{questionContent:t(({record:p})=>[(f(!0),h(B,null,O(JSON.parse(p.questionContent),Y=>(f(),h("div",{key:Y.title},N(Y),1))),128))]),createTime:t(({record:p})=>[n(N(ee(te)(p.createTime).format("YYYY-MM-DD HH:mm:ss")),1)]),updateTime:t(({record:p})=>[n(N(ee(te)(p.updateTime).format("YYYY-MM-DD HH:mm:ss")),1)]),optional:t(({record:p})=>[e(c,null,{default:t(()=>[e(q,{status:"danger",onClick:Y=>P(p)},{default:t(()=>[n("删除")]),_:2},1032,["onClick"]),e(q,{onClick:Y=>v(p)},{default:t(()=>[n("编辑")]),_:2},1032,["onClick"])]),_:2},1024)]),_:1},8,["data","pagination"])]),_:1})]),e(be,{visible:d.value,"onUpdate:visible":l[3]||(l[3]=p=>d.value=p)},null,8,["visible"]),(f(),A(Ve,{key:u.value.id,visible:m.value,"onUpdate:visible":l[4]||(l[4]=p=>m.value=p),question:u.value},null,8,["visible","question"]))],64)}}});export{Qe as default};
